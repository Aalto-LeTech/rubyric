<!-- reviews/edit.html.erb -->

<script id="page-template" type="text/x-handlebars-template">
<div class="tab-pane" id="page-{{id}}">

    <h2>{{name}}</h2>

    <!-- Rubric -->
    <div class="rubric">
    </div>

    <!-- Textareas -->
    <div class="textareas">
      <div>
        <p id="positiveCaption"></p>
        <textarea class="good"></textarea>
      </div>

      <div>
        <p id="negativeCaption"></p>
        <textarea class="bad"></textarea>
      </div>

      <div>
        <p id="commentsCaption"></p>
        <textarea class="neutral"></textarea>
      </div>
    </div>

</div>
</script>

<script id="criterion-template" type="text/x-handlebars-template">
<div class="criterion" id="criterion-container-{{criterionId}}" data-id="{{criterionId}}">
  <!-- Heading -->
  <h3>{{criterionName}}</h3>

  <div class="clear"></div>

  <!-- Phrases -->
  <div class="phrases">
    <table class="phrases">
      <tbody id="phrases-{{criterionId}}">
      </tbody>
    </table>
  </div>
</div>
</script>

<script id="phrase-template" type="text/x-handlebars-template">
<tr class="phrase">
  <td id="phrase-{{id}}" class="phrase">{{content}}</td>
</tr>
</script>

<div class="tabbable tabs-left review-editor" id="review-editor" data-rubric-url="<%= exercise_rubric_url(@exercise.id) %>" data-review-url="<%= review_url(@review.id) %>">
  <ul id="tabs" class="nav nav-tabs">
    <li class="active"><a href="#tab-overview" data-toggle="tab">Overview</a></li>
  </ul>

  <div id="tab-contents" class="tab-content">

    <!-- Overview tab -->
    <div class="tab-pane active" id="tab-overview">
      <div class="row-fluid">
        <h2>Review</h2>

        <!-- Warnings -->
        <% if (@review.status == 'finished') %>
          <div class="alert">
            Warning: This review has already been finished. Altering the review now will overwrite all manual modifications to the finished text.
          </div>
        <% elsif (@review.status == 'mailed') %>
          <div class="alert">
            This review has already been mailed and cannot be modified any more.
          </div>
        <% end %>

        <!-- Notes to grader -->
        <% unless @review.notes_to_grader.blank? %>
          <div class="alert alert-info">
            <%= @review.notes_to_grader %>
          </div>
        <% end %>

        <div class="span4">
          <!-- Group -->
          <h3>Group</h3>

          <table class="table">
            <tbody>
              <% @review.submission.group.users.each do |user| %>
                <tr>
                  <td><%= user.studentnumber %></td>
                  <td><%= user.name %></td>
                  <td><%= user.email %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span4">
          <!-- View submission -->
          <h3>Submission</h3>

          <% unless @review.submission.extension.blank? %>
            <%= link_to "#{@review.submission.filename}", @review.submission %>
            <small>(<%=l @review.submission.created_at %>)</small>
          <% end %>
        </div>
      </div>
    </div> <!-- /tab-overview -->
  </div> <!-- /tab-contents -->
</div> <!-- /tabbable -->

<p><%= link_to 'Back to menu', exercise_path(@exercise.id, :anchor => "group#{@review.submission.group.id}") %></p>
